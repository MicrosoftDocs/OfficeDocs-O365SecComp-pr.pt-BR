---
title: Isolamento de locatário do Office 365 no Office 365 Search
ms.author: robmazz
author: robmazz
manager: laurawi
ms.date: 8/21/2018
audience: ITPro
ms.topic: article
ms.service: Office 365 Administration
localization_priority: None
search.appverid:
- MET150
ms.collection:
- Strat_O365_IP
- M365-security-compliance
description: 'Resumo: uma explicação do isolamento de locatário na pesquisa do Office 365.'
ms.openlocfilehash: b9faae9f1d61af181807f60243890b5115c0d679
ms.sourcegitcommit: c94cb88a9ce5bcc2d3c558f0fcc648519cc264a2
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/20/2019
ms.locfileid: "30090803"
---
# <a name="tenant-isolation-in-office-365-search"></a><span data-ttu-id="72b5e-103">Isolamento de locatário na pesquisa do Office 365</span><span class="sxs-lookup"><span data-stu-id="72b5e-103">Tenant Isolation in Office 365 Search</span></span>
<span data-ttu-id="72b5e-p101">A pesquisa do SharePoint Online usa um modelo de separação de locatários que equilibra a eficiência de estruturas de dados compartilhadas com proteção contra vazamento de informações entre locatários. Com esse modelo, impedimos os recursos de pesquisa de:</span><span class="sxs-lookup"><span data-stu-id="72b5e-p101">SharePoint Online search uses a tenant separation model that balances the efficiency of shared data structures with protection against information leaking between tenants. With this model, we prevent the Search features from:</span></span>
- <span data-ttu-id="72b5e-106">Retornar resultados de consulta que contenham documentos de outros locatários</span><span class="sxs-lookup"><span data-stu-id="72b5e-106">Returning query results that contain documents from other tenants</span></span>
- <span data-ttu-id="72b5e-107">Expor informações suficientes nos resultados de consulta que um usuário experiente pode inferir informações sobre outros locatários</span><span class="sxs-lookup"><span data-stu-id="72b5e-107">Exposing sufficient information in query results that a skilled user could infer information about other tenants</span></span>
- <span data-ttu-id="72b5e-108">Mostrando o esquema ou as configurações de outro locatário</span><span class="sxs-lookup"><span data-stu-id="72b5e-108">Showing schema or settings from another tenant</span></span>
- <span data-ttu-id="72b5e-109">Misturar informações de processamento de análise entre locatários ou armazenar resultados no locatário incorreto</span><span class="sxs-lookup"><span data-stu-id="72b5e-109">Mixing analytics processing information between tenants or store results in the wrong tenant</span></span>
- <span data-ttu-id="72b5e-110">Usando entradas de dicionário de outro locatário</span><span class="sxs-lookup"><span data-stu-id="72b5e-110">Using dictionary entries from another tenant</span></span>

<span data-ttu-id="72b5e-p102">Para cada tipo de dados de locatário, usamos uma ou mais camadas de proteção no código para evitar vazamento acidental de informações. Os dados mais importantes têm mais camadas de proteção para garantir que um único defeito não resulte em vazamento real ou percebido.</span><span class="sxs-lookup"><span data-stu-id="72b5e-p102">For each type of tenant data, we use one or more layers of protection in the code to prevent accidental leaking of information. The most critical data has the most layers of protection to make sure that a single defect doesn't result in actual or perceived information leakage.</span></span>

## <a name="tenant-separation-for-the-search-index"></a><span data-ttu-id="72b5e-113">Separação de locatário para o índice de pesquisa</span><span class="sxs-lookup"><span data-stu-id="72b5e-113">Tenant Separation for the Search Index</span></span>
<span data-ttu-id="72b5e-p103">O índice de pesquisa é armazenado em disco nos servidores que hospedam os componentes do índice e os locatários compartilham os arquivos de índice. Os documentos indexados de um locatário são visíveis apenas para consultas para o locatário. Três mecanismos independentes impedem o vazamento de informações:</span><span class="sxs-lookup"><span data-stu-id="72b5e-p103">The search index is stored on disk in the servers hosting the index components and the tenants share the index files. A tenant's indexed documents are visible only for queries for that tenant. Three independent mechanisms prevent information leakage:</span></span>
- <span data-ttu-id="72b5e-117">Filtragem de ID de locatário</span><span class="sxs-lookup"><span data-stu-id="72b5e-117">Tenant ID filtering</span></span>
- <span data-ttu-id="72b5e-118">Prefixação de termo de ID de locatário</span><span class="sxs-lookup"><span data-stu-id="72b5e-118">Tenant ID term prefixing</span></span>
- <span data-ttu-id="72b5e-119">Verificações de ACL</span><span class="sxs-lookup"><span data-stu-id="72b5e-119">ACL checks</span></span>

<span data-ttu-id="72b5e-120">Todos os três mecanismos teriam falhado para a pesquisa retornar documentos ao locatário errado.</span><span class="sxs-lookup"><span data-stu-id="72b5e-120">All three mechanisms would have to fail for Search to return documents to the wrong tenant.</span></span>

## <a name="tenant-id-filtering-and-tenant-id-term-prefixing"></a><span data-ttu-id="72b5e-121">Filtragem de ID de locatário e prefixação de termos de ID de locatário</span><span class="sxs-lookup"><span data-stu-id="72b5e-121">Tenant ID Filtering and Tenant ID Term Prefixing</span></span>
<span data-ttu-id="72b5e-p104">Os prefixos de pesquisa a cada termo indexado no índice de texto completo com a ID do locatário. Por exemplo, quando o termo "*foo*" é indexado para um locatário com uma ID de "*123*", a entrada no índice de texto completo é "*123foo".*</span><span class="sxs-lookup"><span data-stu-id="72b5e-p104">Search prefixes every term that is indexed in the full-text index with the tenant ID. For example, when the term "*foo*" is indexed for a tenant with an ID of "*123*", the entry in the full-text index is "*123foo.*"</span></span>

<span data-ttu-id="72b5e-p105">Cada consulta é convertida para incluir a ID de locatário usando um processo chamado filtragem de ID de locatário. Por exemplo, a consulta "*foo*" é convertida em "<*GUID*>. *foo* E *tenantid*: <*GUID*_GT_ ", onde <*GUID*> representa o locatário executando a consulta. Essa conversão de consulta ocorre em cada nó de índice, e nenhuma consulta ou o processamento de conteúdo pode influenciar. Como a ID do locatário é adicionada a todas as consultas, a frequência de um termo em outros locatários não pode ser deduzida examinando a melhor classificação de correspondência em um locatário.</span><span class="sxs-lookup"><span data-stu-id="72b5e-p105">Every query is converted to include the tenant ID using a process called tenant ID filtering. For example, the query "*foo*" is converted to "<*guid*>.*foo* AND *tenantID*:<*guid*>", where <*guid*> represents the tenant performing the query. This query conversion occurs within each index node and neither query nor content processing can influence it. Because the tenant ID is added to every query, the frequency of a term in other tenants can't be inferred by looking at best match ranking in one tenant.</span></span>

<span data-ttu-id="72b5e-p106">A prefixação de termos de ID de locatário ocorre somente no índice de texto completo. Pesquisas em campo, como "*título: foo*", acesse um índice de pesquisa sintético em que os termos não são prefixados por ID de locatário. Em vez disso, as pesquisas de campo são prefixadas com o nome do campo. Por exemplo, a consulta "*título: foo*" é convertida em "*Fields. title: foo e Fields. tenantid*: <*GUID*>". Como a frequência de um termo não influencia a classificação de acertos no índice de pesquisa sintética, não há necessidade de separação de locatários por prefixação de termos. Para uma pesquisa em campo como "*título: foo*", a separação de conteúdo do locatário depende da filtragem da ID do locatário por conversão de consulta.</span><span class="sxs-lookup"><span data-stu-id="72b5e-p106">Tenant ID term prefixing occurs only in the full-text index. Fielded searches, such as "*title:foo*", go to a synthetic search index where terms aren't prefixed by tenant ID. Instead, fielded searches are prefixed with the field name. For example, the query "*title:foo*" is converted to "*fields.title:foo AND fields.tenantID*:<*guid*>." Because the frequency of a term doesn't influence ranking of hits in the synthetic search index, there's no need for tenant separation by term prefixing. For a fielded search like "*title:foo*", tenant content separation depends on tenant ID filtering by query conversion.</span></span>

## <a name="document-access-control-list-checks"></a><span data-ttu-id="72b5e-134">Verificações de lista de controle de acesso a documentos</span><span class="sxs-lookup"><span data-stu-id="72b5e-134">Document Access Control List Checks</span></span>
<span data-ttu-id="72b5e-p107">A pesquisa controla o acesso a documentos por meio de ACLs salvas no índice de pesquisa. Cada item é indexado com um conjunto de termos em um campo de ACL especial. O campo ACL contém um termo por grupo ou usuário que pode exibir o documento. Cada consulta é aumentada com uma lista de termos de ACE (entrada de controle de acesso), uma para cada grupo ao qual o usuário autenticado pertence.</span><span class="sxs-lookup"><span data-stu-id="72b5e-p107">Search controls access to documents through ACLs that are saved in the search index. Every item is indexed with a set of terms in a special ACL field. The ACL field contains one term per group or user that can view the document. Every query is augmented with a list of access control entry (ACE) terms, one for each group to which the authenticated user belongs.</span></span>

<span data-ttu-id="72b5e-139">Por exemplo, uma consulta como "<*GUID*>. *foo e tenantid*: <*GUID*> "torna-se:" <*GUID*>. *foo e tenantid*: <*GUID*> *e* (*docacls:*<*ACE1*> *ou docacls*: <*ACE2*> *ou docacls*: <*ace3*> \*... \*)"</span><span class="sxs-lookup"><span data-stu-id="72b5e-139">For example, a query like "<*guid*>.*foo AND tenantID*:<*guid*>" becomes: "<*guid*>.*foo AND tenantID*:<*guid*> *AND* (*docACL:*<*ace1*> *OR docACL*:<*ace2*> *OR docACL*:<*ace3*> *...*)"</span></span>

<span data-ttu-id="72b5e-p108">Como os identificadores de usuário e de grupo e as ACEs são exclusivos, isso fornece um nível extra de segurança entre os locatários para documentos que são visíveis apenas para alguns usuários. O mesmo é o caso da ACE especial "todos exceto usuários externos" que concede acesso a usuários regulares no locatário. No enTanto, como as ACEs de "todos" são as mesmas para todos os locatários, a separação de locatários para documentos públicos depende da filtragem da ID do locatário. As ACEs de negação também são suportadas. O aumento da consulta adiciona uma cláusula que remove um documento do resultado quando há uma correspondência com uma ACE de negação.</span><span class="sxs-lookup"><span data-stu-id="72b5e-p108">Because user and group identifiers and hence ACEs are unique, this provides an extra level of security between tenants for documents that are only visible to some users. The same is the case for the special "Everyone except external users" ACE that grants access to regular users in the tenant. But since ACEs for "Everyone" are the same for all tenants, tenant separation for public documents depends on tenant ID filtering. Deny ACEs are also supported. The query augmentation adds a clause that removes a document from the result when there is a match with a deny ACE.</span></span>

<span data-ttu-id="72b5e-p109">Na pesquisa do Exchange Online, o índice é particionado na ID da caixa de correio para caixas de correio do usuário individual em vez de ID do locatário (ID da assinatura) como no SharePoint Online. O mecanismo de particionamento é o mesmo que o SharePoint Online, mas não há filtragem de ACL.</span><span class="sxs-lookup"><span data-stu-id="72b5e-p109">In Exchange Online search, the index is partitioned on mailbox ID for individual user's mailboxes instead of tenant ID (subscription ID) as in SharePoint Online. The partitioning mechanism is the same as SharePoint Online, but there is no ACL filtering.</span></span>
